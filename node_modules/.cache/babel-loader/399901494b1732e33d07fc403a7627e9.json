{"ast":null,"code":"import _asyncToGenerator from\"/home/mayankawasthi/Strangers.Things/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/mayankawasthi/Strangers.Things/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/mayankawasthi/Strangers.Things/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect}from'react';import{BrowserRouter,Route,Link}from'react-router-dom';import HandleCreatePost from'../helpers/HandleCreatePost';import SendMessage from'./SendMessage';import Profile from'./Profile';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AuthenticatedPosts=function AuthenticatedPosts(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),postId=_useState4[0],setPostId=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),searchTerm=_useState6[0],setSearchTerm=_useState6[1];// console.log(searchTerm);\nvar token=localStorage.getItem(\"userToken\");var handleDelete=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(postIdToDelete){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://strangers-things.herokuapp.com/api/2110-VPI-WEB-PT/posts/\".concat(postIdToDelete),{method:'DELETE',headers:{'Content-Type':'Application/json','Authorization':\"Bearer \".concat(token)}}).then(function(response){return response.json();}).then(function(result){console.log(result);if(result){var newPosts=posts.filter(function(post){return post._id!==postIdToDelete;});setPosts(newPosts);}}).catch(console.error);case 2:response=_context.sent;case 3:case\"end\":return _context.stop();}}},_callee);}));return function handleDelete(_x){return _ref.apply(this,arguments);};}();useEffect(function(){var fetchPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(\"https://strangers-things.herokuapp.com/api/2110-VPI-WEB-PT/posts\",{method:'GET',headers:{'Content-Type':'Application/json','Authorization':\"Bearer \".concat(token)}}).then(function(response){return response.json();}).then(function(result){console.log(result.data.posts);setPosts(result.data.posts);//    setPosts(result.data.posts);\n}).catch(console.error);case 2:response=_context2.sent;case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchPosts(){return _ref2.apply(this,arguments);};}();fetchPosts();},[]);function postMatches(post,text){if(post.title.toLowerCase().includes(text.toLowerCase())){return true;}}var filteredPosts=posts.filter(function(post){return postMatches(post,searchTerm);});var postsToDisplay=searchTerm.length?filteredPosts:posts;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{id:\"title-Addpost\",children:[/*#__PURE__*/_jsx(\"h1\",{id:\"post-title\",children:\"Posts\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search Post...\",value:searchTerm,className:\"search-Bar\",onChange:function onChange(event){return setSearchTerm(event.target.value);}}),/*#__PURE__*/_jsx(Link,{to:\"/posts/add\",className:\"addlink\",children:\"Add Post\"})]}),/*#__PURE__*/_jsx(\"div\",{id:\"main\",children:/*#__PURE__*/_jsx(Route,{path:\"/posts/add\",children:/*#__PURE__*/_jsx(HandleCreatePost,{posts:posts,setPosts:setPosts})})}),postsToDisplay.map(function(post){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:post.title}),/*#__PURE__*/_jsx(\"h4\",{children:post.description}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Price: \",post.price]}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Seller: \",post.author.username]}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Location: \",post.location]}),/*#__PURE__*/_jsx(\"button\",{disabled:post.isAuthor?true:false,className:\"sendMessage\",onClick:function onClick(){return setPostId(post._id);},children:\"Send Message\"}),/*#__PURE__*/_jsx(\"button\",{disabled:post.isAuthor?false:true,className:\"delete-btn\",onClick:function onClick(){return handleDelete(post._id);},children:\"Delete\"}),postId.length?/*#__PURE__*/_jsx(SendMessage,{posts:posts,setPosts:setPosts,postId:postId,setPostId:setPostId}):\"\"]},post._id);})]});};export default AuthenticatedPosts;","map":{"version":3,"sources":["/home/mayankawasthi/Strangers.Things/src/components/AuthenticatedPosts.js"],"names":["React","useState","useEffect","BrowserRouter","Route","Link","HandleCreatePost","SendMessage","Profile","AuthenticatedPosts","posts","setPosts","postId","setPostId","searchTerm","setSearchTerm","token","localStorage","getItem","handleDelete","postIdToDelete","fetch","method","headers","then","response","json","result","console","log","newPosts","filter","post","_id","catch","error","fetchPosts","data","postMatches","text","title","toLowerCase","includes","filteredPosts","postsToDisplay","length","event","target","value","map","description","price","author","username","location","isAuthor"],"mappings":"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","sourcesContent":["\r\nimport React, { useState, useEffect } from 'react';\r\nimport { BrowserRouter, Route, Link } from 'react-router-dom';\r\nimport HandleCreatePost from '../helpers/HandleCreatePost';\r\nimport SendMessage from './SendMessage';\r\nimport Profile from './Profile';\r\n\r\nconst AuthenticatedPosts = () => {\r\n    const [posts, setPosts] = useState([]);\r\n    const [postId, setPostId] = useState(\"\");\r\n    const [searchTerm, setSearchTerm] = useState(\"\");\r\n\r\n    // console.log(searchTerm);\r\n\r\n    const token = localStorage.getItem(\"userToken\")\r\n\r\n    const handleDelete = async (postIdToDelete) => {\r\n        const response = await fetch(`https://strangers-things.herokuapp.com/api/2110-VPI-WEB-PT/posts/${postIdToDelete}`, {\r\n            method: 'DELETE',\r\n            headers: {\r\n                'Content-Type': 'Application/json',\r\n                'Authorization': `Bearer ${token}`\r\n            }\r\n        }).then(response => response.json())\r\n            .then(result => {\r\n                console.log(result);\r\n\r\n                if (result) {\r\n                    const newPosts = posts.filter(post => post._id !== postIdToDelete);\r\n                    setPosts(newPosts)\r\n                }\r\n\r\n            })\r\n            .catch(console.error);\r\n\r\n    }\r\n\r\n    useEffect(() => {\r\n        const fetchPosts = async () => {\r\n\r\n            const response = await fetch(\"https://strangers-things.herokuapp.com/api/2110-VPI-WEB-PT/posts\", {\r\n                method: 'GET',\r\n                headers: {\r\n                    'Content-Type': 'Application/json',\r\n                    'Authorization': `Bearer ${token}`\r\n                },\r\n\r\n            }).then(response => response.json())\r\n                .then(result => {\r\n                    console.log(result.data.posts);\r\n                    setPosts(result.data.posts);\r\n                    //    setPosts(result.data.posts);\r\n                })\r\n                .catch(console.error);\r\n\r\n        }\r\n        fetchPosts();\r\n    }, [])\r\n\r\n    function postMatches(post, text) {\r\n        if (post.title.toLowerCase().includes(text.toLowerCase())) {\r\n            return true\r\n        }\r\n    }\r\n\r\n    const filteredPosts = posts.filter(post => postMatches(post, searchTerm));\r\n    const postsToDisplay = searchTerm.length ? filteredPosts : posts;\r\n\r\n    return (\r\n        <>\r\n\r\n            <div id=\"title-Addpost\">\r\n\r\n                <h1 id=\"post-title\">Posts</h1>\r\n\r\n                <input type=\"text\" placeholder=\"Search Post...\"\r\n                    value={searchTerm} className=\"search-Bar\"\r\n                    onChange={(event) => setSearchTerm(event.target.value)}></input>\r\n\r\n                <Link to=\"/posts/add\" className=\"addlink\">Add Post</Link>\r\n\r\n\r\n            </div>\r\n\r\n            <div id=\"main\">\r\n                <Route path=\"/posts/add\">\r\n                    <HandleCreatePost posts={posts} setPosts={setPosts} />\r\n                </Route>\r\n\r\n            </div>\r\n\r\n            {\r\n\r\n                postsToDisplay.map((post) => (\r\n\r\n                    <div key={post._id}>\r\n                        <h2>{post.title}</h2>\r\n                        <h4>{post.description}</h4>\r\n                        <h3>Price: {post.price}</h3>\r\n                        <h3>Seller: {post.author.username}</h3>\r\n                        <h3>Location: {post.location}</h3>\r\n\r\n                        <button disabled={post.isAuthor ? true : false}\r\n                         className=\"sendMessage\" onClick={() => setPostId(post._id)}>\r\n                         Send Message\r\n                        </button>\r\n\r\n                        <button disabled={post.isAuthor ? false : true}\r\n                         className=\"delete-btn\" onClick={() => handleDelete(post._id)}>\r\n                         Delete\r\n                        </button>\r\n\r\n                        {\r\n                            postId.length ? <SendMessage posts={posts} setPosts={setPosts} postId={postId} setPostId={setPostId} /> : \"\"\r\n                        }\r\n\r\n                    </div>)\r\n                )}\r\n        </>\r\n    )\r\n}\r\nexport default AuthenticatedPosts;\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}